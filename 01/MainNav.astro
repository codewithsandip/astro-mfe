---
const tabs = [
  { label: "Vite Remote", value: "vite" },
  { label: "Webpack Remote", value: "webpack" },
];
---

<nav class="tabs">
  {tabs.map((tab) => (
    <button
      type="button"
      class="tab-button"
      data-tab={tab.value}
    >
      {tab.label}
    </button>
  ))}
</nav>

<style>
  nav.tabs {
    display: flex;
    gap: 24px;
    padding: 0 24px;
    margin-top: 6px;
    border-bottom: 1px solid #e2e8f0;
  }

  .tab-button {
    background: none;
    border: none;
    padding: 12px 0;
    font-size: 0.95rem;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    color: #475569;
  }

  .tab-button.active {
    border-bottom-color: #2563eb; /* highlight border */
    color: #111827;
    font-weight: 600;
  }
</style>

<script>
  if (typeof window !== "undefined") {

    const updateUI = (tab, updateUrl = true) => {
      // highlight button
      document.querySelectorAll(".tab-button").forEach((btn) => {
        btn.classList.toggle("active", btn.dataset.tab === tab);
      });

      // swap web component
      const container = document.getElementById("remote-container");
      container.innerHTML = "";
      const tag = tab === "vite" ? "remote-vite-app" : "remote-webpack-app";
      container.appendChild(document.createElement(tag));

      // update URL without reload
      if (updateUrl) {
        history.pushState({ tab }, "", `/${tab}`);
      }
    };

    // handle click events for buttons
    document.querySelectorAll(".tab-button").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.preventDefault(); // prevent full page navigation
        updateUI(btn.dataset.tab);
      });
    });

    // initial load (deep link support)
    document.addEventListener("DOMContentLoaded", () => {
      const path = location.pathname.replace("/", "");
      const initial = ["vite", "webpack"].includes(path) ? path : "vite";
      updateUI(initial, false);
    });

    // back/forward button support
    window.addEventListener("popstate", (event) => {
      const tab = event.state?.tab || location.pathname.replace("/", "") || "vite";
      updateUI(tab, false);
    });
  }
</script>

